<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lusofy - Beta 1.3</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --lusotur-blue: #041f43;
            --lusotur-yellow: #ffcf00;
            --lusotur-white: #ffffff;
            --bg-primary: #041f43;
            --bg-secondary: #062a5a;
            --bg-card: #0a3570; /* Cor padrão dos cards no modo escuro */
            --bg-card-gradient: linear-gradient(135deg, #0a3570 0%, #041f43 100%);
            --bg-column: #031632;
            --text-primary: #ffffff;
            --text-secondary: #b8c7db;
            --text-muted: #7a8fa8;
            --border-color: #1a4a7a;
            --accent: #ffcf00;
            --accent-hover: #ffe14d;
        }
        
        body { font-family: 'Montserrat', sans-serif; background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); min-height: 100vh; color: var(--text-primary); transition: all 0.3s ease; }
        
        /* MODO DIURNO (Light Theme) Ajustado */
        body.light-theme { 
            --bg-primary: #f0f4f8; 
            --bg-secondary: #e2e8f0; 
            --bg-card: #ffffff; /* Cards gerais brancos */
            --bg-column: #ffffff; /* Colunas brancas */
            --text-primary: #1e293b; 
            --text-secondary: #475569; 
            --text-muted: #94a3b8; 
            --border-color: #cbd5e1; 
            --accent: #041f43; /* Azul como destaque */
            --accent-hover: #062a5a; 
            background: linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 100%); 
        }

        /* Override específico para Task Cards no Light Mode para ficarem azuis */
        body.light-theme .task-card {
            background: linear-gradient(135deg, #041f43 0%, #0a3570 100%);
            color: #ffffff;
            border-color: #1a4a7a;
        }
        body.light-theme .task-card .task-title,
        body.light-theme .task-card .task-info-row,
        body.light-theme .task-card .responsavel-nome,
        body.light-theme .task-card .task-comments {
            color: #ffffff; /* Força texto branco dentro do card azul */
        }
        body.light-theme .task-card .task-info-row { color: #b8c7db; }
        body.light-theme .task-card .responsavel-nome { color: #b8c7db; }
        body.light-theme .task-card .task-comments { color: #7a8fa8; }
        /* Fim das especificações Light Mode */

        h1, h2, h3, h4, h5, h6, .title-font { font-family: 'Oswald', sans-serif; }
        
        /* Header */
        .header { background: rgba(4, 31, 67, 0.98); backdrop-filter: blur(10px); border-bottom: 3px solid var(--accent); padding: 0 24px; height: 70px; display: flex; align-items: center; justify-content: space-between; position: fixed; top: 0; left: 0; right: 0; z-index: 100; }
        body.light-theme .header { background: rgba(255,255,255,0.98); }
        .header-logo { display: flex; align-items: center; gap: 12px; }
        .header-logo h1 { font-size: 1.8rem; font-weight: 700; color: var(--accent); letter-spacing: 2px; text-transform: uppercase; }
        .header-logo .version { font-family: 'Montserrat', sans-serif; font-size: 0.7rem; color: var(--text-muted); background: var(--bg-card); padding: 3px 10px; border-radius: 4px; font-weight: 500; }
        .header-center { display: flex; align-items: center; gap: 16px; flex: 1; justify-content: center; max-width: 600px; margin: 0 24px; }
        .search-box { flex: 1; position: relative; }
        .search-box input { width: 100%; padding: 10px 16px 10px 40px; background: var(--bg-card); border: 2px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-size: 0.85rem; transition: all 0.2s ease; }
        /* Ajuste input search no light mode */
        body.light-theme .search-box input { background: #f1f5f9; border-color: #cbd5e1; color: #333; }

        .search-box input:focus { outline: none; border-color: var(--accent); }
        .search-box input::placeholder { color: var(--text-muted); }
        .search-box svg { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: var(--text-muted); }
        .header-actions { display: flex; align-items: center; gap: 8px; }
        .header-btn { width: 40px; height: 40px; border-radius: 8px; background: var(--bg-card); border: 2px solid var(--border-color); color: var(--text-secondary); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; position: relative; }
        .header-btn:hover { border-color: var(--accent); color: var(--accent); }
        .header-btn.active { background: var(--accent); color: var(--bg-primary); border-color: var(--accent); }
        
        /* Menu Navigation */
        .header-nav { display: flex; gap: 4px; }
        .nav-btn { padding: 8px 16px; border-radius: 6px; font-family: 'Oswald', sans-serif; font-size: 0.8rem; font-weight: 500; cursor: pointer; transition: all 0.2s ease; border: 2px solid transparent; background: transparent; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; }
        .nav-btn:hover { background: rgba(255, 207, 0, 0.1); color: var(--text-primary); border-color: rgba(255, 207, 0, 0.3); }
        .nav-btn.active { background: var(--accent); color: var(--bg-primary); border-color: var(--accent); font-weight: 600; }
        
        .btn-new-task { padding: 10px 16px; width: auto; gap: 6px; font-family: 'Oswald', sans-serif; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px; background: var(--accent); color: var(--bg-primary); border-color: var(--accent); font-weight: 600; }
        .btn-new-task:hover { background: var(--accent-hover); }

        /* Dashboard & Charts */
        .charts-section { padding: 24px 24px 0 24px; margin-top: 80px; }
        .charts-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 24px; }
        .chart-card { background: var(--bg-card); border-radius: 12px; padding: 16px; border: 1px solid var(--border-color); height: 280px; position: relative; }
        .chart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .chart-title { font-family: 'Oswald', sans-serif; font-size: 0.9rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        
        @media (max-width: 1024px) { .charts-row { grid-template-columns: 1fr; height: auto; } .chart-card { height: 300px; } }

        /* Main Content */
        .main-content { padding-top: 0; padding-bottom: 24px; transition: padding-top 0.3s ease; }
        .kanban-container { padding: 0 24px 24px 24px; overflow-x: auto; }
        .kanban-board { display: flex; gap: 16px; min-width: max-content; padding-bottom: 24px; }
        
        /* Columns */
        .kanban-column { width: 320px; min-width: 320px; background: var(--bg-column); border-radius: 12px; border: 1px solid var(--border-color); display: flex; flex-direction: column; max-height: calc(100vh - 400px); /* Ajustado para caber gráficos */ }
        .kanban-column.concluidos { opacity: 0.8; }
        .column-header { padding: 16px; border-bottom: 1px solid var(--border-color); display: flex; align-items: center; justify-content: space-between; background: var(--bg-column); border-radius: 12px 12px 0 0; position: sticky; top: 0; z-index: 10; }
        .column-title { display: flex; align-items: center; gap: 10px; }
        .column-tipo-dot { width: 12px; height: 12px; border-radius: 50%; }
        .column-name { font-family: 'Oswald', sans-serif; font-weight: 600; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .column-count { background: var(--bg-card); color: var(--accent); font-size: 0.75rem; padding: 3px 10px; border-radius: 12px; font-weight: 600; }
        .column-cards { flex: 1; padding: 12px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        
        /* Task Cards */
        .task-card { background: var(--bg-card); border-radius: 10px; border: 1px solid var(--border-color); padding: 14px; cursor: grab; transition: all 0.2s ease; position: relative; }
        .task-card:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3); }
        .task-card.dragging { opacity: 0.5; cursor: grabbing; transform: rotate(3deg); }
        
        /* Badges */
        .task-status-badge { font-family: 'Oswald', sans-serif; font-size: 0.6rem; font-weight: 600; padding: 3px 8px; border-radius: 4px; text-transform: uppercase; letter-spacing: 0.5px; white-space: nowrap; }
        .status-nao_iniciado { background: rgba(107, 114, 128, 0.25); color: #9ca3af; border: 1px solid rgba(107, 114, 128, 0.4); }
        .status-em_andamento { background: rgba(59, 130, 246, 0.25); color: #93c5fd; border: 1px solid rgba(59, 130, 246, 0.4); }
        .status-concluido { background: rgba(34, 197, 94, 0.25); color: #86efac; border: 1px solid rgba(34, 197, 94, 0.4); }
        .status-bloqueado { background: rgba(239, 68, 68, 0.25); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.4); }

        /* Dados Censurados (Continuando o CSS que estava cortado) */
        .dados-censurados-coletar .campo-pagamento label { 
            font-size: 0.7rem; 
            color: var(--text-muted); 
            text-transform: uppercase; 
            display: block; 
            margin-bottom: 4px; 
            font-weight: 600;
        }
        .dados-censurados-coletar .campo-pagamento span {
            font-family: 'Oswald', monospace;
            font-size: 1rem;
            color: var(--text-primary);
        }
    </style>
</head>
<body>

    <header class="header">
        <div class="header-logo">
            <h1>Lusofy</h1>
            <span class="version">Beta 1.3</span>
        </div>
        
        <div class="header-center">
            <div class="search-box">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <input type="text" id="searchInput" placeholder="Buscar tarefas (título, tag, responsável)..." onkeyup="filtrarTarefas()">
            </div>
        </div>

        <nav class="header-nav" style="margin-right: 16px;">
            <button class="nav-btn active">Kanban</button>
            <button class="nav-btn">Faturamento</button>
            <button class="nav-btn">Financeiro</button>
            <button class="nav-btn">Meu Perfil</button>
        </nav>

        <div class="header-actions">
            <button class="header-btn" onclick="toggleTheme()" title="Alternar Tema">
                <svg id="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
            </button>
            <button class="btn-new-task">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="18" height="18">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                </svg>
                Nova Tarefa
            </button>
        </div>
    </header>

    <div class="charts-section">
        <div class="charts-row">
            <div class="chart-card">
                <div class="chart-header">
                    <span class="chart-title">Conclusões (Últimos 7 dias)</span>
                </div>
                <div style="height: 220px; width: 100%;">
                    <canvas id="chartLine"></canvas>
                </div>
            </div>
            
            <div class="chart-card">
                <div class="chart-header">
                    <span class="chart-title">Concluídas por Responsável</span>
                </div>
                <div style="height: 220px; width: 100%; display: flex; justify-content: center;">
                    <canvas id="chartPie"></canvas>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <span class="chart-title">Pendentes por Pessoa</span>
                </div>
                <div style="height: 220px; width: 100%;">
                    <canvas id="chartBar"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="kanban-container">
            <div class="kanban-board">
                
                <div class="kanban-column">
                    <div class="column-header">
                        <div class="column-title">
                            <div class="column-tipo-dot" style="background: #9ca3af;"></div>
                            <span class="column-name">A Fazer</span>
                        </div>
                        <span class="column-count">3</span>
                    </div>
                    <div class="column-cards" id="col-todo">
                        <div class="task-card">
                            <div class="task-card-header">
                                <span class="task-status-badge status-nao_iniciado">Não Iniciado</span>
                                <span class="task-priority priority-alta">Alta</span>
                            </div>
                            <div class="task-title">Revisar documentação financeira</div>
                            <div class="task-card-footer">
                                <div class="task-responsavel">
                                    <div class="responsavel-avatar">JP</div>
                                    <span class="responsavel-nome">João Paulo</span>
                                </div>
                            </div>
                        </div>
                        <div class="task-card">
                            <div class="task-card-header">
                                <span class="task-status-badge status-nao_iniciado">Não Iniciado</span>
                                <span class="task-priority priority-media">Média</span>
                            </div>
                            <div class="task-title">Aprovar orçamento Marketing</div>
                            <div class="task-card-footer">
                                <div class="task-responsavel">
                                    <div class="responsavel-avatar">AN</div>
                                    <span class="responsavel-nome">Ana N.</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="kanban-column">
                    <div class="column-header">
                        <div class="column-title">
                            <div class="column-tipo-dot" style="background: #3b82f6;"></div>
                            <span class="column-name">Em Andamento</span>
                        </div>
                        <span class="column-count">2</span>
                    </div>
                    <div class="column-cards" id="col-progress">
                        <div class="task-card">
                            <div class="task-card-header">
                                <span class="task-status-badge status-em_andamento">Em Andamento</span>
                                <span class="task-priority priority-urgente">Urgente</span>
                            </div>
                            <div class="task-title">Correção do bug de login</div>
                            <div class="task-card-footer">
                                <div class="task-responsavel">
                                    <div class="responsavel-avatar">DV</div>
                                    <span class="responsavel-nome">Dev Team</span>
                                </div>
                            </div>
                        </div>
                         <div class="task-card">
                            <div class="task-card-header">
                                <span class="task-status-badge status-em_andamento">Em Andamento</span>
                            </div>
                            <div class="task-title">Atualizar Design System</div>
                            <div class="task-card-footer">
                                <div class="task-responsavel">
                                    <div class="responsavel-avatar">DS</div>
                                    <span class="responsavel-nome">Designer</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="kanban-column">
                    <div class="column-header">
                        <div class="column-title">
                            <div class="column-tipo-dot" style="background: #ef4444;"></div>
                            <span class="column-name">Bloqueado</span>
                        </div>
                        <span class="column-count">1</span>
                    </div>
                    <div class="column-cards" id="col-blocked">
                        <div class="task-card">
                            <div class="task-card-header">
                                <span class="task-status-badge status-bloqueado">Bloqueado</span>
                            </div>
                            <div class="task-title">Aguardando Cliente</div>
                            <div class="task-card-footer">
                                <div class="task-responsavel">
                                    <div class="responsavel-avatar">CM</div>
                                    <span class="responsavel-nome">Comercial</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="kanban-column concluidos">
                    <div class="column-header">
                        <div class="column-title">
                            <div class="column-tipo-dot" style="background: #22c55e;"></div>
                            <span class="column-name">Concluídos Recentes</span>
                        </div>
                        <span class="column-count">4</span>
                    </div>
                    <div class="column-cards" id="col-done">
                        <div class="task-card">
                            <div class="task-card-header">
                                <span class="task-status-badge status-concluido">Concluído</span>
                            </div>
                            <div class="task-title">Deploy v1.2</div>
                            <div class="task-card-footer">
                                <div class="task-responsavel">
                                    <div class="responsavel-avatar">DV</div>
                                    <span class="responsavel-nome">Dev Team</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // --- 1. Função de Busca de Tarefas ---
        function filtrarTarefas() {
            const termo = document.getElementById('searchInput').value.toLowerCase();
            const cards = document.querySelectorAll('.task-card');

            cards.forEach(card => {
                const titulo = card.querySelector('.task-title').innerText.toLowerCase();
                const responsavel = card.querySelector('.responsavel-nome').innerText.toLowerCase();
                
                // Verifica se o termo existe no título ou no responsável
                if (titulo.includes(termo) || responsavel.includes(termo)) {
                    card.style.display = "block";
                } else {
                    card.style.display = "none";
                }
            });
        }

        // --- 2. Toggle Theme (Light/Dark) ---
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            atualizarGraficos(); // Atualiza cores dos gráficos se necessário
        }

        // --- 3. Inicialização dos Gráficos com Chart.js ---
        document.addEventListener("DOMContentLoaded", function() {
            const commonOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { labels: { color: '#7a8fa8', font: { family: 'Montserrat' } } }
                },
                scales: {
                    y: { ticks: { color: '#7a8fa8' }, grid: { color: 'rgba(122, 143, 168, 0.1)' } },
                    x: { ticks: { color: '#7a8fa8' }, grid: { color: 'rgba(122, 143, 168, 0.1)' } }
                }
            };
            
            const pieOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'right', labels: { color: '#7a8fa8' } }
                }
            };

            // Gráfico de Linha (Conclusão por dia)
            new Chart(document.getElementById('chartLine'), {
                type: 'line',
                data: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    datasets: [{
                        label: 'Tarefas Concluídas',
                        data: [5, 8, 3, 12, 6, 4, 7],
                        borderColor: '#ffcf00',
                        backgroundColor: 'rgba(255, 207, 0, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: commonOptions
            });

            // Gráfico de Pizza (Concluídas por Responsável)
            new Chart(document.getElementById('chartPie'), {
                type: 'doughnut',
                data: {
                    labels: ['João', 'Maria', 'Dev Team', 'Design'],
                    datasets: [{
                        data: [12, 19, 8, 5],
                        backgroundColor: ['#ffcf00', '#22c55e', '#3b82f6', '#ec4899'],
                        borderWidth: 0
                    }]
                },
                options: pieOptions
            });

            // Gráfico de Barras (Pendentes por Pessoa)
            new Chart(document.getElementById('chartBar'), {
                type: 'bar',
                data: {
                    labels: ['João', 'Maria', 'Pedro', 'Ana'],
                    datasets: [{
                        label: 'Tarefas Pendentes',
                        data: [4, 7, 2, 5],
                        backgroundColor: '#3b82f6',
                        borderRadius: 4
                    }]
                },
                options: commonOptions
            });
        });

        // Atualizar cor dos textos dos gráficos ao trocar tema
        function atualizarGraficos() {
            // Recarrega gráficos se necessário para adaptar cores das legendas
            // Simulação simples: charts já herdam CSS variables se configurado, 
            // mas aqui mantive estático para garantir funcionamento imediato.
        }
    </script>
</body>
</html>
